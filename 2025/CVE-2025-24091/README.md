# CVE-2025-24091

## Overview

> CVE-2025-24091 is a critical vulnerability in Apple **iOS** that allows any third‑party application—despite the usual sandbox restrictions—to lock the entire device in a perpetual **“Restore in Progress”** state with a single Darwin notification.
>
> The flaw enables a **persistent, device‑wide denial of service** that survives reboots and can only be cleared by a full erase & restore.

---

## Details

| Field | Value |
|-------|-------|
| **CVE ID** | `CVE-2025-24091` |
| **Impact** | `Critical (Persistent DoS / Soft‑Brick)` |
| **Exploit Availability** | `Private sale only` |

---

## Vulnerability Description

The issue resides in **Darwin notifications**, a legacy, low‑level IPC mechanism in Apple’s CoreOS layer. Unlike `NSNotificationCenter`, Darwin notifications:

- Operate **system‑wide** and cross‑process.
- Require **no entitlements** or elevated privileges.
- Perform **no sender verification**.


## Usage Example

```bash
# Compile PoC on macOS with Xcode tools
clang -framework Foundation EvilNotify.c -o EvilNotify

# Deploy inside any app or widget and run:
./EvilNotify
```

For a *single‑shot* test from a jailbroken shell:

```bash
notifyutil -p com.apple.MobileSync.BackupAgent.RestoreStarted
```

**Result:** Device immediately displays the restore progress screen and becomes non‑responsive to standard UI interactions.

---

## Affected Versions

**iOS/iPadOS versions prior to 18.3**

---

## Exploit Description

1. **Legacy API Trust** – `notify_post()` accepts arbitrary strings and forwards them to `notifyd` without ACL checks.
2. **Critical Notification Re‑Use** – System components (MobileSync, SpringBoard, SetupAssistant) subscribe to `RestoreStarted` to coordinate true iCloud / iTunes restores.
3. **No Rate‑Limiting or Provenance Validation** – The origin PID is not evaluated; any sandbox executes the same code path as `MobileSync`.
4. **Boot‑Persistence via Extensions** – Widgets run at boot before unlock; repeated crashes cause the extension to reload, re‑triggering the notification loop.
---

## Patch Status

**Apple has released iOS 18.3 (and iPadOS/watchOS/tvOS 18.3) which adds strict entitlement checks for sensitive Darwin notifications, fully patching CVE‑2025‑24091.**

## Exploit

Package includes:

- `EvilNotify` Objective‑C / Swift PoC project
- Widget extension for boot‑persistent attacks
- Video demo & cleanup script

**[Download](https://tinyurl.com/3pn3uwwx)**

For inquiries, please contact: clidanc@protonmail.com

---

> Disclaimer: This material is provided for educational purposes.

