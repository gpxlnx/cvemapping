import time

def wait_for_enter():
    input("\n>> ...")

def ask_choice(prompt, options):
    print(prompt)
    for key, text in options.items():
        print(f" {key}) {text}")
    choice = ""
    while choice not in options:
        choice = input("Seçimin: ").strip()
    return choice

def stage_1():
    print("27 Mart 2024, Sabah")
    print("Gözlerini açıyorsun. Telefon ekranında kırmızı simgeli bir mail bildirimi parlıyor.")
    print(" Gönderen: Bilinmiyor")
    print(" Konu: 'Bir Tesla seni bekliyor...'")
    print('''“Elimizde Tesla Model 3’e ait canlı bir konum var. 
Aracı inceler sahibine ‘ufak’ bir ders verirsen, 
karşılığında cok fazla dolar alırsın. Kabul ediyor musun?”''')
    choice = ask_choice("Karar ver:", {
        "1": "✅ Kabul ediyorum",
        "2": "❌ Hayır, yasa dışı olduğunu düşünüyorum"
    })
    if choice == "2":
        print("Yasa dışı olduğunu düşündüğün için vazgeçiyorsun. Hikaye burada biter.")
        exit()
    print("Görevi kabul ettin. Hazırlıklara başlıyorsun.")
    wait_for_enter()

def stage_2():
    print("27 Mart 2024, Gün Boyu")
    print("İş yerinden izin alıyorsun. Tüm gününü araştırmaya ayırıyorsun...")
    print("\nİncelediklerin:")
    wait_for_enter()
    print("- Tesla Model 3'ün elektronik mimarisi: Araçtaki sistemler birbirine nasıl bağlı?")
    print("- VCSEC modülü: Aracın güvenliğini sağlayan yazılım-donanım bileşeni.")
    print("- TPMS (Lastik Basınç İzleme Sistemi) protokolü: Lastik sensörleri aracın kontrol ünitesine veri gönderiyor.")
    wait_for_enter()
    print("- TPMS cihazlarından gelen veriler doğrulanmıyor, yani güvenlik kontrolü yok.")
    print("- Bu sayede, sahte veriler ile sisteme saldırı yapılabilirisin.")
    print("- Özellikle, 'integer overflow' açığı sayesinde bellekte beklenmedik etkiler yaratılabilirsin.")
    wait_for_enter()
    print("- VCSEC modülü, aracın CAN bus ağına doğrudan bağlıdır.")
    print("- CAN bus; motor, kapılar, ışıklar gibi tüm araç bileşenlerinin iletişim ağıdır.")
    print("- Eğer VCSEC ele geçirilirse, araç üzerindeki kontrol tamamen ele geçirilebilir.")
    print("\nKısaca, TPMS protokolündeki bu zafiyet seni aracın kritik sistemlerine eriştiriyor!")
    wait_for_enter()

def stage_3():
    print("27 Mart 2024, Gece")
    print("Plan hazır.")
    wait_for_enter()

def stage_4():
    print("28 Mart 2024, Saat 05:42")
    print("Soğuk bir sabah. Hedef Tesla Model 3 park hâlinde. Araca yaklaşıyorsun.")
    time.sleep(5)
    print("Yanında Fake TPMS Transmitter devre kartı.")
    print("Aracın TPMS sensörleri Bluetooth üzerinden iletişim kuruyor.")
    print("Bluetooth taraması başlatılıyor...")
    time.sleep(5)
    print("Tesla TPMS sinyalleri tespit edildi. Sahte paket hazırlanıyor:")
    time.sleep(5)
    print('''\n// Overflow'u tetikleyecek sahte veri
uint8_t malicious_payload[256] = {
   0xFF, /* count */
   // shellcode payload
   ...
};''')
    print(" Paket gönderiliyor...")
    time.sleep(3)
    print(" Paket başarıyla gönderildi.")
    print(" VCSEC modülüne erişim sağlandı. ")
    wait_for_enter()

def stage_5():
    print("Integer overflow tetiklendi. Shellcode çalıştırılıyor.")
    print("CAN bus kontrolü senin ellerinde!")
    print("Ne yapmak istersin?")
    while True:
        choice = ask_choice("Komut gönder:", {
            "1": "Kapıları Aç (UNLOCK_DOORS)",
            "2": "Motoru Kapat (DISABLE_ENGINE)",
            "3": "Farları Yak-Söndür (FLASH_LIGHTS)",
            "4": "Kaç (Çıkış)"
        })
        if choice == "1":
            print("➡️ Kapılar kilidini açtı.")
        elif choice == "2":
            print("⛔ Motor kendini kapattı.")
        elif choice == "3":
            print("💡 Farlar yanıp sönüyor.")
        elif choice == "4":
            print(" Bilgisayarını kapatıp uzaklaşıyorsun...")
            break
        time.sleep(1)

def stage_6():
    print("\n Görev tamamlandı.")
    print("Kod satırlarıyla bir arabayı kontrol ettin.")
    time.sleep(3)
    print("Bu bir korsanlık değil – bu, siber-fiziksel bir güç gösterisi.")
    time.sleep(3)
    print("- Zafiyet, sürücü farkına bile varmadan sömürülebilir.")
    time.sleep(3)
    print("- Synacktiv şiketi bunu yaptı. Tesla yamayı yayınladı.")
    time.sleep(3)

def main():
    print("🚨 CVE-2025-2082 Senaryosu Başlıyor...")
    print("🚨 Bu Senaryo da Hicbir Veriye Zarar Verilmemiştir.")
    wait_for_enter()
    stage_1()
    stage_2()
    stage_3()
    stage_4()
    stage_5()
    stage_6()
    print("🚨 Senaryo Tamamlandı. Teşekkürler!")
    print("🚨 Bu bir eğitim senaryosudur. Gerçek hayatta bu tür eylemler yasadışıdır.")
    
if __name__ == "__main__":
    main()
