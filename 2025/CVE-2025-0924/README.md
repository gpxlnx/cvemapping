# CVE-2025-0924
## 01. Stored XSS와 WordPress,WP Activity Log  개요
- ### 1) Stored XSS와 WordPress,WP Activity Log  개요
  Stored XSS는 악성 스크립트가 서버에 저장되어, 이후 다른 사용자들이 해당 페이지를 열 때 자동으로 실행되는 취약점이며  
  CWE-79(Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting'))로 지정 되어있는 공격의 일종 입니다.
  
  WordPress는 전 세계적으로 가장 인기 있는 오픈 소스 CMS(콘텐츠 관리 시스템)로, 웹사이트와 블로그를 쉽게 구축하고 관리할 수 있게 해줍니다. 사용자가 코드 지식 없이도 다양한 플러그인과 테마를 통해 사이트를 확장하고 커스터마이징할 수 있습니다.

  WP Activity Log는 WordPress 사이트의 관리 활동을 추적하고 기록하는 플러그인입니다. 관리자가 사이트에서 발생한 다양한 이벤트를 실시간으로 모니터링하고, 보안 감사나 문제 해결을 위한 로그를 제공하는 데 유용합니다
  
  CVE-2025-0924은 WP Activity Log 플러그인(5.2.2 이하 버전)은 'message' 파라미터에서 입력 검증 부족과 출력 이스케이프 미비로 인해 발생하며 해당 취약점이 어떻게 발생하는지 살펴보고 이에 따른 대응 방안을 모색 해보고자 합니다.
## 02. WP Activity Log 5.2.2 환경의 Stored XSS 취약점 분석
- ### 2.1 WP Activity Log 5.2.2을 이용한 Stored XSS 분석
   WordPress 에서 사용자가 사이트 제목에 악성 스크립트를 복사 붙여 넣고 해당 변경 사항이 WP Activity Log 5.2.2를 통해 로그가 설정 되면 Stored XSS 공격이 이루어 집니다. 예제를 살펴 보며 WP Activity Log를 이용해 어떻게 Stored XSS가 유발 되는지 알아 보겠습니다.
  #### 1) 로그를 통한 XSS 공격 흐름
  <p align="center"> <img src="https://github.com/user-attachments/assets/79e208a1-6d2d-4f11-9a0f-508abf178cc5" alt="이미지 설명"> </p>
  <p align="center">[그림 1] WordPress 글 작성, DB 스크립트 삽입 </p> 
  [그림 1]을 보면, 처음 로그 생성을 위해 게시글을 생성합니다. 이 과정에서 두 개의 글을 작성하는데, 하나는 직접 타이핑하여 입력하고, 다른 하나는 복사하여 붙여넣는 방식으로 입력을 진행합니다.  
  
  게시글 생성 후 데이터베이스를 확인하면, 복사하여 붙여넣은 게시글의 경우 post_title 필드의 값이 적절히 **sanitize(입력 값 정리 및 필터링)**되지 않고 저장되는 현상을 확인할 수 있습니다.
  
  이는 입력 방식에 따라 데이터가 다르게 처리될 가능성을 시사하며, XSS(크로스 사이트 스크립팅) 취약점이 발생할 수 있는 원인이 될 수 있습니다.
  <p align="center"> <img src="https://github.com/user-attachments/assets/79e208a1-6d2d-4f11-9a0f-508abf178cc5" alt="이미지 설명"> </p>
  <p align="center">[그림 2]  WP Activity Log 로그 생성및 공격 체크</p> 
