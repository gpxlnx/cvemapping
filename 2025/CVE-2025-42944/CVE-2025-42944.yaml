id: CVE-2025-42944

info:
  name: Detection for CVE-2025-42944
  author: rxerium
  severity: critical
  description: |
    Due to a deserialization vulnerability in SAP NetWeaver, an unauthenticated attacker could exploit the system through the RMI-P4 module by submitting malicious payload to an open port. The deserialization of such untrusted Java objects could lead to arbitrary OS command execution, posing a high impact to the application's confidentiality, integrity, and availability.
  metadata:
    verified: true
    max-request: 1
    shodan-query: http.favicon.hash:-266008933
    product: content_server
    vendor: sap
  tags: sap,webserver

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    redirects: true
    max-redirects: 2

    extractors:
      - type: regex
        part: header
        name: version
        regex:
          - "SAP NetWeaver Application Server ([0-9]+\\.[0-9]+)"
        group: 1

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - "SAP NetWeaver Application Server"
        condition: or
        case-insensitive: true

      - type: dsl
        dsl:
          - compare_versions(version, '<= 7.50')
