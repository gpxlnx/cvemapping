# CVE-2025-34157 – Stored XSS in Coolify Project Delete Flow

## 📝 Summary
A stored XSS vulnerability exists in **Coolify ≤ v4.0.0-beta.420.6**.  
A low-privileged user can create a project with a malicious name.  
When an **administrator attempts to delete the project**, attacker-controlled JavaScript is executed in the admin’s browser.  

This enables session hijacking, token theft, and full compromise of the Coolify instance.

---

## 🧪 Proof of Concept (PoC)

1. **Log in** with a regular (non-admin) user account.  
2. **Create a new project** with the following malicious name:

```
<details x=xxxxxxxxxxxxxxxxxx:2 open ontoggle="prompt('PoC');">
```

3. Inside this project, add any resource (e.g., GitLab, Docker image, etc.).  
4. When an **administrator try to delete the project**, the payload is automatically executed.  

---

## 🎯 Impact

The malicious JavaScript runs in the **administrator’s browser context**, allowing the attacker to:

- Steal **session cookies**  
- Exfiltrate **API tokens / XSRF token**  
- Intercept and manipulate **WebSocket communication**  
- Gain **terminal access** to connected servers  

This vulnerability can be chained with other features to:  
- Escalate privileges  
- Manipulate projects/resources  
- Maintain **persistent access** across the Coolify instance  

---

## ⚙️ CVSS v4.0 Score

**CNA:  VulnCheck**

**CVSS-B 9.4 CRITICAL**

**Vector:  CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H**

## 🔗 References
- [CVE Record – CVE-2025-34157](https://www.cve.org/cverecord?id=CVE-2025-34157)
