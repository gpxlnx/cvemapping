#  Incident Report: Suspicious Outbound Connection on Atlas

##  Date:
June 24, 2025

##  Affected System:
- Hostname: Atlas
- Role: Wazuh Agent
- OS: Ubuntu Linux (prior to latest image upgrade)

---

## 🔍 Summary

During routine monitoring, I (Jeffrey) observed Atlas initiating an *unusual outbound HTTP connection* to the IP address 197.155.77.1:80.

The IP served a web page exposing raw *directory listings* with a folder named CPAN/. No Perl-related activity had ever been configured on Atlas, raising a serious red flag for possible misconfiguration or compromise.

---

##  Investigation Timeline

| Time | Action |
|------|--------|
| T+0  | Detected outbound connection via curl to 197.155.77.1:80 |
| T+5  | Accessed the IP in browser – found exposed /CPAN/ directory |
| T+10 | Ran lsof, ss, ps, cron, and full grep sweeps — found *no Perl or process trail* |
| T+15 | Traced behavior back to *previous Linux image upgrade* attempt, interrupted due to power outage |
| T+20 | Re-attempted upgrade → error message showed APT trying to fetch from 197.155.77.1:80 |
| T+25 | Confirmed the IP was acting as a *fallback mirror* for Linux package updates |
| T+30 | Verified mirror not present in sources.list, likely added via geo-mirror redirect or embedded fallback |
| T+35 | Manually completed upgrade, flushed APT cache, and restored secure state |

---

##  Root Cause

> *APT fallback to an exposed Linux mirror (197.155.77.1)* during a vulnerability patch triggered by CVE-2025-27558.

The server was poorly configured:
- Directory listing enabled
- Served over HTTP instead of HTTPS
- Returned 404 errors for some package requests

---

## Resolution

- Completed the interrupted Linux upgrade
- Ran sudo apt clean to clear residual mirror info
- Verified no mirror presence in sources.list or .list.d
- Confirmed system stability and secure patching

---

##  Lessons Learned

- Outbound connections should always be traced, even if temporary
- APT can fall back to insecure or unexpected mirrors
- Mirrors using plain HTTP are *a serious attack surface*
- Tools like Wazuh and manual netstat/log analysis can uncover silent misconfigurations

---

##  Skills Demonstrated

- Threat hunting
- Network forensics
- Vulnerability mitigation (CVE-2025-27558)
- Mirror validation
- Secure Linux patching
- Incident reporting & documentation

---

##  Next Steps

- Add Wazuh rules to alert on outbound HTTP (optional hardening)
- Continue CVE tracking and patch management
- Snapshot current secure state of Atlas and Ghost-shell

---

Logged and resolved by: Jeffrey (a.k.a. Ghostbuster)  
Investigated with: Atlas Maru Shepherd 

---![Screenshot 2025-06-25 133236](https://github.com/user-attachments/assets/20c09707-643a-4b43-8725-3939215c99cf)
