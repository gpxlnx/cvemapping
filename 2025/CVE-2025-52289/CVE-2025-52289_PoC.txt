Title: Broken Access Control in MagnusBilling < v7.8.5.3 Allows Users to Self-Activate Without Admin Approval 

Description: A Broken Access Control vulnerability exists in MagnusBilling versions prior to < v7.8.5.3 that allows a newly registered user to escalate their account status from “pending” to “active” without requiring admin approval. By intercepting and modifying a client-side request during profile update, the user can bypass the intended account approval workflow. This behavior can lead to unauthorized access and misuse of system resources.

Impact: High

Proof of Conecpt:

1. Register a New Account: Navigate to the signup page and register a new user with valid details.
2. Login as the New User: Log in using the newly registered account. Note that this user is placed in a “pending” state. 
3. Admin Verification: In a separate browser/session, log in as admin and verify that the new user is listed with status = pending. Normally, only the admin can activate this user. 
4. Intercept and Modify Request: 
  -> While logged in as the new user, go to the edit profile section. 
  -> Intercept the request when saving changes using Burp Suite. 
  -> The request to the following endpoint is intercepted: /mbilling/index.php/user/save 
5. Modify Payload: 
  -> The intercepted request will contain a rows parameter with encoded JSON: 
      {"firstname":"edit","contract_value":"0.0000","id":6} 
  -> Modify it by adding the active parameter: 
      {"firstname":"edit","active":1,"contract_value":"0.0000","id":6} 
  -> Forward the modified request. 
6. Verify the Exploit: Go back to the admin panel and observe that the user account status is now set to Active, without any admin approval.
