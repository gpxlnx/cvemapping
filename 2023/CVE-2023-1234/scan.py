# exploits/CVE-2023-1234.py

import sys
import socket

def exploit(target_ip):
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((target_ip, 80))  # giả sử port 80
        # gửi payload khai thác
        s.sendall(b"GET /vulnerable_endpoint HTTP/1.1\r\nHost: " + target_ip.encode() + b"\r\n\r\n")
        resp = s.recv(1024)
        if b"VULNERABLE" in resp:
            print("SUCCESS: Exploit worked")
        else:
            print("FAIL: Exploit failed")
        s.close()
    except Exception as e:
        print("ERROR:", e)

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python CVE-2023-1234.py <target_ip>")
        sys.exit(1)
    exploit(sys.argv[1])
