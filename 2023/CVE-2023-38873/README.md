# üö® G1 => A05:2021 ‚Äì Security Misconfiguration [ClickJacking]
# ‚ö†Ô∏è Pontua√ß√£o base: 6.5 M√âDIO Escala: CVSS ‚ö†Ô∏è

![image](https://github.com/user-attachments/assets/463ae380-d267-4fba-bbc0-dff7ea3458a9)

## üìå Descri√ß√£o
Este reposit√≥rio demonstra uma falha de seguran√ßa do tipo **Clickjacking** presente no site do **G1**. A vulnerabilidade permite que um invasor carregue o site dentro de um **iframe**, sobrepondo elementos maliciosos para enganar o usu√°rio.

## ‚ö†Ô∏è O Que √© Clickjacking?
Clickjacking (tamb√©m conhecido como UI Redressing) √© um ataque que engana o usu√°rio, fazendo-o interagir com uma p√°gina leg√≠tima sem perceber. Isso pode ser explorado para:
- **Roubar credenciais**
- **Executar a√ß√µes n√£o intencionais**
- **Enganar o usu√°rio para baixar malware**

## üî• Como a Falha Funciona?
O c√≥digo HTML deste reposit√≥rio carrega o site do **G1** dentro de um iframe de **tela cheia** e exibe um **popup falso** sugerindo o download de um aplicativo.

Os riscos incluem:
- O usu√°rio pode ser induzido a clicar em links ou baixar arquivos maliciosos.
- O site n√£o implementa cabe√ßalhos de seguran√ßa adequados, como `X-Frame-Options` ou `Content-Security-Policy`.

## üõ°Ô∏è Como Corrigir?
Para mitigar ataques de **Clickjacking**, os administradores do site devem:
1. **Adicionar o cabe√ßalho `X-Frame-Options`** para impedir o carregamento em iframes:
   ```
   X-Frame-Options: DENY
   ```
2. **Implementar `Content-Security-Policy (CSP)`** para restringir iframes:
   ```
   Content-Security-Policy: frame-ancestors 'none';
   ```
3. **Utilizar JavaScript** para detectar e bloquear iframes n√£o autorizados.

## üìö Refer√™ncias de Seguran√ßa
### OWASP Top 10
Clickjacking √© um problema de seguran√ßa reconhecido pelo **OWASP Top 10**, um dos principais guias de seguran√ßa de aplica√ß√µes web. Ele se encaixa na categoria **A05:2021 - Vulnerable and Outdated Components**, pois a aus√™ncia de cabe√ßalhos de prote√ß√£o contra iframes exp√µe usu√°rios a ataques.

Mais informa√ß√µes: [OWASP Clickjacking](https://owasp.org/www-community/attacks/Clickjacking)

### MITRE ATT&CK
No framework **MITRE ATT&CK**, o Clickjacking √© classificado sob a t√©cnica **T1204 - User Execution**, pois explora a intera√ß√£o do usu√°rio para realizar a√ß√µes sem consentimento.

Mais informa√ß√µes: [MITRE ATT&CK - T1204](https://attack.mitre.org/techniques/T1204/)

## üì¢ Aviso
Este reposit√≥rio √© apenas para fins educacionais e de pesquisa em seguran√ßa. **N√£o utilize este c√≥digo para fins maliciosos!**

## Provas de Conceito [PoC]

Escrevi o [index.html](https://github.com/K9-Modz/CVE-2023-38873-G1/blob/main/index.html)  que renderizara uma pagina da WEB (especiais.g1.globo.com/app-g1/index.html). Esta pagina possui uma falha alta pois nao possui o X-Frame dentro dos cabe√ßalhos. Permitindo que possamos renderizar (e roubar) uma pagina inteira original e hospedarmos dentro do nosso servidor ou host em que tenhamos controle.

[Explore o site aqui:](file:///D:/User/Desktop/index.html) 

[![Image](https://github.com/user-attachments/assets/7a9a2ee4-5098-423e-be35-cd4df4079951)

Na se√ß√£o inicial da p√°gina renderizada comprometida, inseri um bloco de c√≥digo no cabe√ßalho (head) que disparar√° um pop-up ap√≥s um intervalo de 2 segundos. Esse pop-up foi estrategicamente desenvolvido para facilitar a execu√ß√£o de t√©cnicas de Engenharia Social. Essa abordagem permitir√° a implementa√ß√£o de um mecanismo de Drive-By Download, possibilitando o download autom√°tico de conte√∫do malicioso diretamente no dispositivo do usu√°rio. Uma vez conclu√≠do o download, o c√≥digo malicioso poder√° ser executado, abrindo caminho para a instala√ß√£o de diversos payloads, como um RAT (Remote Access Trojan), Ransomware, Infostealer, entre outras amea√ßas cibern√©ticas.

Nesta prova de conceito adicionei uma imagem para que seja aberta: 
![image](https://github.com/user-attachments/assets/d8d76c64-dbc3-4b63-b124-3e77a003f943)
