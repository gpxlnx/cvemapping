#/usr/bin/python3

import socket
import binascii
import ebcdic
import sys
import time
import struct

host = sys.argv[1]
cmd = sys.argv[2]

sockfd = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sockfd.settimeout(1)
sockfd.connect((host, int(446)))

data = binascii.unhexlify("007ed0010000007810410009115ee3c2d6e7f2000b114700070009d8c1e2006014041403000314230003140500031406000314070003147400051458000114570003140c000314190003141e000314220003240f0003143200031433000314400001143b0003240700031463000314650003143c0003147f000414a00004")
sockfd.send(data)
recv = sockfd.recv(1024)

data = binascii.unhexlify("001cd00100010016106d000611a20006000c11dc0000017fdb25cb5e")
sockfd.send(data)
recv = sockfd.recv(1024)

data = binascii.unhexlify("002ad00100000024106e000611a20006000e11a0e4e2c5d9c2f140404040000c11a1d3836b559964b999")

sockfd.send(data)
recv = sockfd.recv(1024)

frame  = struct.pack(">H", len(cmd) + 14) + b"\xd0\x01\x00\x02"
frame += struct.pack(">H", len(cmd) + 8)  + b"\xd0\x06"
frame += struct.pack(">H", len(cmd) + 4)  + b"\xd1\x03"
frame += cmd.encode("cp500")

sockfd.send(frame)
recv = sockfd.recv(1024)
sockfd.close()
