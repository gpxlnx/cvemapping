# CVE-2024-12856
This is an exploit for Four-Faith router models F3x24 and F3x36 to get a reverse shell.

"The Four-Faith router models F3x24 and F3x36 are affected by an operating system (OS) command injection vulnerability. At least firmware version 2.0 allows authenticated and remote attackers to execute arbitrary OS commands over HTTP when modifying the system time via apply.cgi. Additionally, this firmware version has default credentials which, if not changed, would effectively change this vulnerability into an unauthenticated and remote OS command execution issue."

_Source: [nist.gov](https://nvd.nist.gov/vuln/detail/CVE-2024-12856)_

This script is based on a payload observed by [VulnCheck](https://vulncheck.com/blog/four-faith-cve-2024-12856)

## How to use
Before running the exploit start a TCP server on your machine.\
Then run
 
```python exploit.py [-u USERNAME] [-p PASSWORD] [-rport REMOTE_PORT] RHOST LHOST LPORT```

Where
-  `RHOST` is the remote IP address. You can also add a domain.
-  `LHOST` is the IP of your TCP server on your machine.
-  `LPORT` is the port of your TCP server
-  `USERNAME` and `PASSWORD` are the credentials of the router. The default is admin:admin.
-  `RPORT` is the remote port of the router. Default is 80


## Disclaimer
Make sure to use this exploit only for testing and in authorized environments.

Never use it for malicious purposes.