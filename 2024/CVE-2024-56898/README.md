# CVE-2024-56898
CVE-2024-56898 - Broken access control vulnerability in [Geovision GV-ASManager](https://www.geovision.com.tw) web application with version v6.1.0.0 or less.

# Requirements
To perform successful attack an attacker requires:
  - GeoVision ASManager version 6.1.0.0 or less
  - Network access to the GV-ASManager web application (there are cases when there are public access)
  - Access to Guest account (enabled by default), or any low privilege account (Username: `Guest`; Password: `<blank>`)

# Impact
The vulnerability can be leveraged to **perform the following unauthorized actions**:
+ A low privilege account which isn't authorized to manage accounts is able to:
  - Enable and disable any account.
  - Create new accounts.
  - Modify privileges of any account.
  - Listing accounts and their information.
+ After the escalation of the privileges, **an attacker will be able to**:
  - Access the resources such as monitoring cameras, access cards, parking cars, employees and visitors, etc.
  - Make changes in data and service network configurations such as employees, access card security information, IP addresses and configurations, etc.
  - Disrupt and disconnect services such as monitoring cameras, access controls.
  - Clone and duplicate access control data for further attack scenarios.
  - Perform [CVE-2024-56902](https://github.com/DRAGOWN/CVE-2024-56902) attack to retrieve cleartext password that can be reused in other digital assets of the organization.

# CVE-2024-56898 PoC [Testing GeoVision v6.1.0.0]
### Operators:

<img src="https://github.com/user-attachments/assets/04502d72-962b-4bde-bbec-94107fdc20b3" width="700">

> Accounts list before we start attack
  
In the list of operators there are the Administrator account and Guest account enabled by default [Username: `Guest`; Password: `<blank>`], and there are no Users added (low privilege accounts).

### Creating a new account with Guest account:
<img src="https://github.com/user-attachments/assets/0e9c7ad9-9caa-4836-a9b2-46658b51016b" width="700">

> Guest account has permission only to change his/her account and theme

As it is visible in the screenshot above, a Guest account has no privilege to manage accounts or anything in ASWeb.

<img src="https://github.com/user-attachments/assets/6b689b41-824c-4818-a2de-e17c64bbfff0" width="700">

> Adding a new low-privilege account "JustUser" with unauthorized Guest account

Despite the unsuccessful response, the JustUser account is still created by Guest account, visible in the screenshot below.
<img src="https://github.com/user-attachments/assets/967f5a08-348e-4696-9cda-720697bb0ac9" width="700">

> Administrator's view: JustUser has been added by unauthorized Guest account

From the Administrator's view we see that the JustUser account has been created by unauthorized Guest account. As it is visible, JustUser account still doesn't have write and execute privileges, which will be escalated in the next screenshot.

### Escalating privileges for JustUser account from Guest account:
<img src="https://github.com/user-attachments/assets/5b6c043a-0696-4aec-9b4f-63305350958b" width="700">

> Escalating JustUser's privilege with unauthorized Guest account

In the screenshot below, we escalated privileges for JustUser from low-privilege to the Administrator by using Guest account. The escalation was done with manipulating `level` from `1` [Users] to `2` [Supervisor/Administrator].

<img src="https://github.com/user-attachments/assets/3b2167ea-e5ac-45a1-910e-93a9a66dbd46" width="700">

> JustUser account got administrative permission

From the Administrator's view we see that the JustUser account's privilege has been escalated by unauthorized Guest account. And now the administrator isn't able to make modification in the privileges of JustUser account anymore.

**Note: Here we demonstrated the steps of creating account and escalating privileges separately, while it is possible to do it together with just one request.**

### Full access in the web application. 
As JustUser account has Administrator privilege, now the attacker has full access in the AS Manager (Including ASWeb, TAWeb, VMWeb, ASManager software in OS)

<img src="https://github.com/user-attachments/assets/55e200da-5e28-4c17-bca2-e54f6a4b3a68" width="700">

> JustUser is an administrator in ASWeb

<img src="https://github.com/user-attachments/assets/7178fc40-701d-4df8-9ab9-972c996304f3" width="700">

> JustUser is an administrator in TAWeb

<img src="https://github.com/user-attachments/assets/f779e07b-ab04-460f-94f0-b61a3bcd664e" width="700">

> JustUser is an administrator in VMWeb

<img src="https://github.com/user-attachments/assets/260a2651-9132-4d31-8833-2ea7d02fffe3" width="700">

> JustUser is an administrator in ASManager

<img src="https://github.com/user-attachments/assets/96d3106a-d241-4fb9-a435-d34b83eee300" width="700">

> JustUser is an administrator in ASManager software in OS


```
ASWeb	- Access & Security Management 
TAWeb	- Time and Attendance Management 
VMWeb	- Visitor Management 
ASManager - Access & Security Management software in OS
```

### Finally, we can remove the legit Administrator account: 
<img src="https://github.com/user-attachments/assets/721331c3-d0d2-48eb-8e30-ce6b78e4631d" width="700">

> Removing legit administrator account

<img src="https://github.com/user-attachments/assets/45296d0d-ae90-4378-82f3-cf363b88660c" width="700">

> The legit administrator account has been deleted


### The vendor of the product **GeoVision** is informed and they already released the newest fixed version 6.1.2.0 (as of January 2025)
**INFO: While the version 6.1.1.0 is also fixed to the above described vulnerability, it is still vulnerable to another attack - Cross-Site Request Forgery [Described here: [LINK](https://github.com/DRAGOWN/CVE-2024-56901)].**

Download the latest version from [here](https://www.geovision.com.tw/download/product/)

## Contact
If you have a question, you can contact me, Giorgi Dograshvili on [LinkedIn](https://ge.linkedin.com/in/giorgi-dograshvili).
